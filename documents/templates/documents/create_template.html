{% extends "base.html" %}
{% load static %}



{% block title %}Créer un modèle — {{ clinic_info.name }}{% endblock %}

{% block content %}
<style>
  /* --- Styles locaux --- */
  .variable {
    background: #eef3ff;
    border-radius: 4px;
    padding: 2px 4px;
    font-weight: 500;
  }

  .page.a4 { width: 210mm; min-height: 297mm; margin: auto; }
  .page.a5 { width: 148mm; min-height: 210mm; margin: auto; }

  #toolbar {
    flex-wrap: wrap;
    gap: 0.5rem;
    width: 100%;
    background: #f8f9fa;
    border-bottom: 1px solid #ccc;
    border-radius: 6px 6px 0 0;
    padding: 6px;
    position: relative;
    z-index: 10;
  }

  .ql-toolbar button, .ql-toolbar select { margin: 0 !important; }

  #editorContainer {
    width: 100%;
    background: white;
    border: 1px solid #ccc;
    border-radius: 0 0 6px 6px;
    position: relative;
    z-index: 1;
    min-height: 400px;
    box-sizing: border-box;
  }

  #editor { min-height: 400px; padding: 12px; }

  #pageSize { width: auto !important; display: inline-block; }

  
</style>

<div class="container mt-4">
  <div class="card shadow-sm border-0">
    <div class="card-header bg-primary text-white d-flex justify-content-between align-items-center">
      <h4 class="mb-0">Créer un modèle de document</h4>
      <a href="{% url 'documents:template_list' %}" class="btn btn-light btn-sm">← Retour</a>
    </div>

    <div class="card-body">
      <form method="post" id="templateForm">
        {% csrf_token %}
        <div class="mb-3">
          <label for="name" class="form-label fw-bold">Nom du modèle :</label>
          <input type="text" name="name" id="name" class="form-control" placeholder="Ex : Attestation, Certificat médical..." required>
        </div>

        <div class="mb-3">
          <label class="form-label fw-bold">Contenu du modèle :</label>

          <!-- Toolbar -->
          <div class="mb-2">
            <div id="toolbar" class="ql-toolbar ql-snow flex-wrap w-100 border rounded-top bg-light">
              <select class="ql-header" title="Taille du titre">
                <option value="1">Titre 1</option>
                <option value="2">Titre 2</option>
                <option selected>Normal</option>
              </select>

              <div class="btn-group">
                <button class="ql-bold btn btn-sm btn-outline-primary"><b>B</b></button>
                <button class="ql-italic btn btn-sm btn-outline-primary"><i>I</i></button>
                <button class="ql-underline btn btn-sm btn-outline-primary"><u>U</u></button>
              </div>

              <div class="btn-group">
                <button class="ql-list btn btn-sm btn-outline-secondary" value="ordered"><i class="bi bi-list-ol"></i></button>
                <button class="ql-list btn btn-sm btn-outline-secondary" value="bullet"><i class="bi bi-list-ul"></i></button>
              </div>

              <div class="btn-group">
                <button class="ql-link btn btn-sm btn-outline-success"><i class="bi bi-link-45deg"></i></button>
                <button id="customImageBtn" type="button" class="btn btn-sm btn-outline-success"><i class="bi bi-image"></i></button>
              </div>

              <div class="btn-group ms-2">
                <button id="insertTableBtn" type="button" class="btn btn-sm btn-outline-primary"><i class="bi bi-table"></i></button>
                <button id="insertRowBtn" type="button" class="btn btn-sm btn-outline-success"><i class="bi bi-plus-lg"></i></button>
                <button id="insertColBtn" type="button" class="btn btn-sm btn-outline-success"><i class="bi bi-plus"></i></button>
                <button id="deleteRowBtn" type="button" class="btn btn-sm btn-outline-danger"><i class="bi bi-dash-lg"></i></button>
                <button id="deleteColBtn" type="button" class="btn btn-sm btn-outline-danger"><i class="bi bi-dash"></i></button>
                <button id="deleteTableBtn" type="button" class="btn btn-sm btn-outline-danger"><i class="bi bi-x-lg"></i></button>
              </div>

              <button class="ql-clean btn btn-sm btn-outline-danger"><i class="bi bi-eraser"></i></button>

              <select id="pageSize" class="form-select form-select-sm ms-3" title="Format page">
                <option value="a4" selected>A4 (210 × 297 mm)</option>
                <option value="a5">A5 (148 × 210 mm)</option>
              </select>

              <button type="button" id="addVariableBtn" class="btn btn-sm btn-outline-secondary ms-3"><i class="bi bi-plus-circle"></i></button>
            </div>
          </div>

          <div id="editorContainer" class="page a4 border shadow-sm p-3 bg-white">
            <div id="editor"></div>
          </div>

          <input type="hidden" name="content" id="content">
        </div>

        <div class="d-grid">
          <button type="submit" class="btn btn-primary btn-lg">Enregistrer le modèle</button>
        </div>
      </form>
    </div>
  </div>
</div>

{% endblock content %}

  



{% block extra_scripts %}
{{ block.super }}

<link href="{% static 'css/quill.snow.css' %}" rel="stylesheet">
<script src="{% static 'js/quill.min.js' %}"></script>
<script src="{% static 'js/quill.imageUploader.min.js' %}"></script>

<script src="{% static 'js/scripts.js' %}"></script>



{% endblock %}


