{% extends "base.html" %}
{% load static %}

{% block content %}
<div class="container my-4">
  <div class="d-flex justify-content-between align-items-center mb-4">
    <h2>Prévisualisation du thème du cabinet</h2>
    <a href="{% url 'core:clinic_info_update' %}" class="btn btn-secondary">Modifier les paramètres</a>
  </div>

  <div class="card shadow-sm mb-4">
    <div class="card-header">
      <strong>Aperçu du style actuel</strong>
    </div>
    <div class="card-body text-center" id="preview-card" style="
      background-color: var(--background-color);
      color: var(--text-color);
      border-color: var(--primary-color);
      transition: all 0.3s ease;
      padding: 2rem;
    ">
      {% if clinic_info.logo %}
        <img src="{{ clinic_info.logo.url }}" alt="Logo" style="max-height:80px; margin-bottom:15px;">
      {% endif %}
      <h3>{{ clinic_info.name }}</h3>
      <p>{{ clinic_info.slogan }}</p>
      <p><small>{{ clinic_info.address }}</small></p>
      <p><small>{{ clinic_info.phone }} | {{ clinic_info.email }}</small></p>

      <div class="mt-3">
        <button class="btn btn-primary me-2">Bouton principal</button>
        <button class="btn btn-secondary">Bouton secondaire</button>
      </div>
    </div>
  </div>

  <div class="d-flex justify-content-between">
    <a href="{% url 'core:toggle_theme' %}" class="btn btn-outline-primary" id="toggle-btn">
      {% if theme_mode == "dark" %}
        <i class="bi bi-sun"></i> Basculer en mode clair
      {% else %}
        <i class="bi bi-moon"></i> Basculer en mode sombre
      {% endif %}
    </a>

    <form method="post" action="{% url 'core:clinic_info_update' %}">
      {% csrf_token %}
      <button type="submit" class="btn btn-success">
        <i class="bi bi-check-circle"></i> Appliquer ce thème
      </button>
    </form>
  </div>
</div>

<script>
  // Bascule instantanée du thème sans rechargement
  const toggleBtn = document.getElementById('toggle-btn');
  toggleBtn.addEventListener('click', function (e) {
    e.preventDefault();
    const current = document.body.getAttribute('data-theme');
    const next = current === 'dark' ? 'light' : 'dark';
    document.body.setAttribute('data-theme', next);
    fetch(this.href).then(() => console.log("Thème basculé"));
  });
</script>
{% endblock %}
